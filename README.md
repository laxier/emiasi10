# EMIAS Bot & Web Panel ‚Äì –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏ –∞–≤—Ç–æ–∑–∞–ø–∏—Å—å

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç: Telegram‚Äë–±–æ—Ç + –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Flask) –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤—Ä–∞—á–µ–π –ï–ú–ò–ê–°, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –≥–∏–±–∫–∏–º –ø—Ä–∞–≤–∏–ª–∞–º –∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∞–≤—Ç–æ–∑–∞–ø–∏—Å–∏ –Ω–∞ —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã.

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* ü§ñ Telegram‚Äë–±–æ—Ç: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–∞—á–µ–π, –ø—Ä–∞–≤–∏–ª–∞, —Å–ª–æ—Ç—ã, –∞–≤—Ç–æ–∑–∞–ø–∏—Å—å.
* üåê –í–µ–±‚Äë–ø–∞–Ω–µ–ª—å: –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö, –ø—Ä–∞–≤–∫–∞ –ø—Ä–∞–≤–∏–ª, –ª–æ–≥–æ–≤, —Ç–æ–∫–µ–Ω–æ–≤.
* üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —Å–ª–æ—Ç–∞.
* üì¶ SQLite –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é + –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω—é—é –ë–î —á–µ—Ä–µ–∑ `DATABASE_URL`.
* üìù –ñ—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π (audit log) –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–¥–º–∏–Ω–∞.

## üìê –§–æ—Ä–º–∞—Ç –ø—Ä–∞–≤–∏–ª –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

–ü—Ä–∞–≤–∏–ª–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î –∫–∞–∫ —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤:
```jsonc
[
	{"type": "weekday", "value": "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "timeRanges": ["08:00-12:00"]},
	{"type": "date", "value": "2025-10-10", "timeRanges": ["16:00-17:00"]}
]
```

–í—ã –º–æ–∂–µ—Ç–µ –≤–≤–æ–¥–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ, —Ä–∞–∑–¥–µ–ª—è—è –∑–∞–ø—è—Ç—ã–º–∏:
```
–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫: 08:00-12:00, 10.10: 09:00-11:00, 2025-10-10 16:00-17:00, –∑–∞–≤—Ç—Ä–∞ 14:00-16:00
```

–î–æ–ø—É—Å—Ç–∏–º—ã–µ —Ñ–æ—Ä–º—ã:
| –¢–∏–ø | –ü—Ä–∏–º–µ—Ä | –ü–æ—è—Å–Ω–µ–Ω–∏–µ |
|-----|--------|-----------|
| –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ | `—Å—Ä–µ–¥–∞: 10:00-13:00` | –ü–æ–≤—Ç–æ—Ä—è—é—â–µ–µ—Å—è –ø—Ä–∞–≤–∏–ª–æ |
| –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ | `—Å–µ–≥–æ–¥–Ω—è 12:00-15:00` | –§–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ –¥–∞—Ç—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è |
| ISO –¥–∞—Ç–∞ | `2025-10-10 16:00-17:00` –∏–ª–∏ `2025-10-10: 16:00-17:00` | –û–¥–Ω–æ–¥–Ω–µ–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ |
| DD.MM | `10.10 09:00-11:00` –∏–ª–∏ `10.10: 09:00-11:00` | –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π –≥–æ–¥ |
| –†—É—Å—Å–∫–∞—è –¥–∞—Ç–∞ | `25 –º–∞—Ä—Ç–∞ 09:00-11:00` | –ú–µ—Å—è—Ü —Å–ª–æ–≤–∞–º–∏ |
| –ë–µ–∑ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ | `–ø—è—Ç–Ω–∏—Ü–∞` | –õ—é–±–æ–µ –≤—Ä–µ–º—è –¥–Ω—è |

–ù–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –¥–ª—è –æ–¥–Ω–æ–≥–æ –¥–Ω—è: `–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫: 08:00-10:00; 12:00-14:00`.

–ó–∞–º–µ–Ω–∞ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª –≤ –±–æ—Ç–µ: –Ω–∞—á–Ω–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å `!`
```
! –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫: 08:00-12:00, 2025-10-10 16:00-17:00
```


## üóÑÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤
```
emiasik-master/
‚îú‚îÄ‚îÄ bot.py
‚îú‚îÄ‚îÄ web_app.py
‚îú‚îÄ‚îÄ rules_parser.py
‚îú‚îÄ‚îÄ database.py
‚îú‚îÄ‚îÄ emias_api.py
‚îú‚îÄ‚îÄ run_all.py
‚îú‚îÄ‚îÄ templates/
‚îú‚îÄ‚îÄ data/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ README.md
```

## üß© –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)
| –ú–æ–¥–µ–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------------|
| UserProfile | OMS, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è, –ø–∞—Ä–æ–ª—å –≤–µ–±-–¥–æ—Å—Ç—É–ø–∞, is_admin |
| UserToken | –¢–æ–∫–µ–Ω—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫ API –ï–ú–ò–ê–° |
| DoctorInfo | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤—Ä–∞—á–µ–π/—Ä–µ—Å—É—Ä—Å–æ–≤ |
| UserTrackedDoctor | –ó–∞–ø–∏—Å—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è + `tracking_rules`, `auto_booking`, `active` |
| DoctorSchedule | –ö–µ—à —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π (—Å—ã—Ä—ã–µ JSON —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã) |
| UserFavoriteDoctor | –°–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –≤—Ä–∞—á–µ–π |
| UserLog | –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π (–∞—É–¥–∏—Ç) |

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-------------|--------------|----------|
| TELEGRAM_BOT_TOKEN | ‚úÖ | ‚Äî | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ |
| SECRET_KEY | ‚úÖ | `default_secret_key` | Flask —Å–µ—Å—Å–∏–∏ (–∑–∞–º–µ–Ω–∏—Ç–µ –≤ –ø—Ä–æ–¥–µ) |
| DATABASE_URL | ‚ùå | sqlite:///data/emias_bot.db | –í–Ω–µ—à–Ω—è—è –ë–î (PostgreSQL, etc.) |
| LOG_LEVEL | ‚ùå | INFO | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è |

–ü—Ä–∏–º–µ—Ä `.env`:
```
TELEGRAM_BOT_TOKEN=123456:ABC...
SECRET_KEY=change_me
LOG_LEVEL=DEBUG
```

## üê≥ Docker / Docker Compose
### –û–±—ã—á–Ω—ã–π Docker
```bash
docker build -t emias-bot .
docker run -d \
	-p 8000:8000 \
	-e TELEGRAM_BOT_TOKEN=... \
	-e SECRET_KEY=... \
	-v $(pwd)/data:/app/data \
	emias-bot
```

### docker-compose.yml
```yaml
services:
	emias:
		build: .
		restart: unless-stopped
		environment:
			TELEGRAM_BOT_TOKEN: ${TELEGRAM_BOT_TOKEN}
			SECRET_KEY: ${SECRET_KEY}
		volumes:
			- ./data:/app/data
		ports:
			- "8000:8000"
```
–ó–∞–ø—É—Å–∫:
```bash
docker compose up -d --build
```